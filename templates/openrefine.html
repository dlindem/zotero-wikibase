<!doctype html>
<html>
<head>
<link href="static/favicon.ico" rel="shortcut icon"/>
    <title>Creators CSV for Open Refine - ZotWb</title>
</head>
<body>
<h1>ZotWb Open Refine reconciliation</h1>
{% for message in messages %}<p style = "{{ msgcolor }}">{{ message }}<br>{% endfor %}
<p> <small>(Back to <a href="/">start page</a>)</small></p>
<p>On this page, you can produce CSV for loading into Open Refine, start the reconciliation service for {{ wikibase_name }}, and import reconciliation result CSV produced in Open Refine back to {{ wikibase_name }}.</p>
<h2>Export creator literals (unreconciled creator data)</h2>
<p><form style="display: inline;" method="POST">
    <button name="export_unreconciled_creators" type="submit">Produce CSV</button>
</form> to save a CSV containing unreconciled creator literals to <code><b>data/unreconciled_creators</b></code> folder.</p>
<h2>Import creator entities (reconciled creator data)</h2>
<p><a href="./openrefine">Refresh this page</a> to load the most recent CSV exported from Open Refine in <code><b>data/reconciled_creators</b></code> folder.</p>
The currently loaded file, <code><b>{{ filename }}</b></code>, contains:
<ul>
    <li>{{ recon_all }} rows in total</li>
    <li>{{ recon_wd }} of {{ recon_all }} are linked to Wikidata items</li>
    <li>{{ recon_wb }} of {{ recon_all }} are linked to {{ wikibase_name }} items</li>
</ul>
<p><form style="display: inline;" method="POST">
    <button name="import_reconciled_wikidata" type="submit">Use Wikidata alignment</button>
</form> to import {{ recon_wd }} creators from Wikidata to Wikibase, and set their Wikibase item as creatorstatement value.</br><small>If the creator is known to {{ wikibase_name }}, because the same CSV row contains a Wikibase-Qid, or a creator linked to the same Wikidata Qid exists on {{ wikibase_name }}, no duplicate will be created.</small></p>
<p><form style="display: inline;" method="POST">
    <button name="import_reconciled_wikibase" type="submit">Set creator statement values</button>
</form> to set {{ recon_wb }} creatorstatement values.</br><small>This simply updates the unknown value to the Wikibase Qid found in the CSV row.</small> </p>
    <p><form style="display: inline;" method="POST">
    <button name="import_unreconciled" type="submit">Create new items</button>
</form> to create a new item for each creator cluster.</br><small>This processes CSV rows without Wikidata or Wikibase Qid.</br>Rows with identical values in the <code>fullName_clusters</code> column will result one single item.</small></p>
<h2>Start {{ wikibase_name }} reconciliation servie</h2>
<p>To start the reconciliation service, open a new terminal in your zotwb folder, and type:
<p><code>source zotwbenv/bin/activate</br>cd reconciliator</br>python3 -m reconciliator</code></p>
The service should then run at <a href="http://0.0.0.0:8000" target="_blank">0.0.0.0:8000</a>.</p>
<p>To start Open Refine, open a new terminal in the Open Refine folder, e.g. 'openrefine-3.7.6', and type:
    <p><code>./reconcile</code></p>
Open Refine should then run at <a href="http://127.0.0.1:3333" target="_blank">127.0.0.1:3333</a>.</p>

</body>
</html>